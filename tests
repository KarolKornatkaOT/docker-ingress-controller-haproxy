#ip_List=$(curl -s  192.168.1.150:8080/api/v1/namespaces/default/endpoints/nginx-1 |  jq  --arg kind Pod '.subsets[] |select(.addresses[].targetRef.kind == $kind).addresses[].ip ' |sort |uniq )
PORTS="81 443"
svc="nginx-1"
IPS="192.168.1.12 192.168.33"


for port in $PORTS; do
    echo -e  "frontend front_"$svc"_$port\n  bind *:$port\n  mode tcp\n  default_backend backend_"$svc"_$port\n" >> test.cfg
    echo -e  "backend backend_"$svc"_$port\n  mode tcp\n  balance leastconn\n  maxconn 10000  " >> test.cfg
    for ip in $IPS; do
    echo -e  "  se2rver $ip \t $ip:$port  inter 1s fastinter 1s check  " >> test.cfg
    done
    echo "\n"  >> test.cfg
    done

# for ip in $IPS; do
# echo -e  "backend backend_$svc\n  mode tcp\n  balance leastconn\n  maxconn 10000\n  server $ip \n" >> test.cfg
# done
